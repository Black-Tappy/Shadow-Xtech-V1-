/*                                   
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
made by Black-Tappy
contact owner +254759000340

CURRENTLY RUNNING ON BETA VERSION!!
*
   * @project_name : Shadow-Xtech-V1 
   * @author : Ⴊl𐌀Ꮳk𐌕𐌀ႲႲჄ
   * @youtube : https://www.youtube.com/@Black-Tappy
   * @infoription : Shadow-Xtech-V1 ,A Multi-functional whatsapp user bot.
   * @version 10 
*
   * Licensed under the  GPL-3.0 License;
* 
   * ┌┤Created By Black-Tappy tech info.
   * © 2025 Shadow-Xtech-V1 ✭ ⛥.
   * plugin date : 16/5/2025
* 
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   * SOFTWARE.
*/
const _0x42dbe9 = function () {
  let _0x12d6c2 = true;
  return function (_0x151f2c, _0x1210a2) {
    const _0x2b0a93 = _0x12d6c2 ? function () {
      if (_0x1210a2) {
        const _0x3a8012 = _0x1210a2.apply(_0x151f2c, arguments);
        _0x1210a2 = null;
        return _0x3a8012;
      }
    } : function () {};
    _0x12d6c2 = false;
    return _0x2b0a93;
  };
}();
const _0xd51a05 = _0x42dbe9(this, function () {
  return _0xd51a05.toString().search("(((.+)+)+)+$").toString().constructor(_0xd51a05).search("(((.+)+)+)+$");
});
_0xd51a05();
const _0x535b7f = function () {
  let _0x26aef8 = true;
  return function (_0xf39be9, _0x10c74a) {
    const _0x5a4d68 = _0x26aef8 ? function () {
      if (_0x10c74a) {
        const _0x5cf2e3 = _0x10c74a.apply(_0xf39be9, arguments);
        _0x10c74a = null;
        return _0x5cf2e3;
      }
    } : function () {};
    _0x26aef8 = false;
    return _0x5a4d68;
  };
}();
(function () {
  _0x535b7f(this, function () {
    const _0x3e61ff = new RegExp("function *\\( *\\)");
    const _0x4aa927 = new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)", 'i');
    const _0x33b50e = _0x5c98df("init");
    if (!_0x3e61ff.test(_0x33b50e + "chain") || !_0x4aa927.test(_0x33b50e + "input")) {
      _0x33b50e('0');
    } else {
      _0x5c98df();
    }
  })();
})();
(function () {
  const _0x26839c = function () {
    let _0x3fd7ee;
    try {
      _0x3fd7ee = Function("return (function() {}.constructor(\"return this\")( ));")();
    } catch (_0x39378b) {
      _0x3fd7ee = window;
    }
    return _0x3fd7ee;
  };
  const _0xdce2e0 = _0x26839c();
  _0xdce2e0.setInterval(_0x5c98df, 4000);
})();
const _0x4fbaed = function () {
  const _0x2bbcdb = {
    cqDKk: function (_0x30d55d, _0x15a9b1) {
      return _0x30d55d === _0x15a9b1;
    },
    MqMzh: "bOaFS",
    aFTpo: "DcZSo",
    NXYvf: "yGJxH"
  };
  _0x2bbcdb.bDQzT = function (_0x2b3cf5, _0x1ef393) {
    return _0x2b3cf5 !== _0x1ef393;
  };
  _0x2bbcdb.rlPxt = "pTfoL";
  let _0x1a14f0 = true;
  return function (_0xa75c31, _0x24d6b5) {
    if (_0x2bbcdb.bDQzT(_0x2bbcdb.rlPxt, _0x2bbcdb.rlPxt)) {
      const _0x4a76a1 = _0x555f52 ? function () {
        if (_0x55e3d8) {
          const _0x116894 = _0x27a006.apply(_0x5e9242, arguments);
          _0x284e9a = null;
          return _0x116894;
        }
      } : function () {};
      _0x3d6261 = false;
      return _0x4a76a1;
    } else {
      const _0x4dbade = _0x1a14f0 ? function () {
        if (_0x24d6b5) {
          const _0x1202f8 = _0x24d6b5.apply(_0xa75c31, arguments);
          _0x24d6b5 = null;
          return _0x1202f8;
        }
      } : function () {};
      _0x1a14f0 = false;
      return _0x4dbade;
    }
  };
}();
const _0x572a3e = _0x4fbaed(this, function () {
  let _0x2eaad3;
  try {
    const _0x433fe5 = Function("return (function() {}.constructor(\"return this\")( ));");
    _0x2eaad3 = _0x433fe5();
  } catch (_0x1452fc) {
    _0x2eaad3 = window;
  }
  const _0x307ce3 = _0x2eaad3.console = _0x2eaad3.console || {};
  const _0x19cb13 = ["log", "warn", "info", "error", "exception", "table", "trace"];
  for (let _0x44c9c8 = 0; _0x44c9c8 < _0x19cb13.length; _0x44c9c8++) {
    const _0x556dd0 = _0x4fbaed.constructor.prototype.bind(_0x4fbaed);
    const _0x4d20d1 = _0x19cb13[_0x44c9c8];
    const _0x5708ae = _0x307ce3[_0x4d20d1] || _0x556dd0;
    _0x556dd0.__proto__ = _0x4fbaed.bind(_0x4fbaed);
    _0x556dd0.toString = _0x5708ae.toString.bind(_0x5708ae);
    _0x307ce3[_0x4d20d1] = _0x556dd0;
  }
});
_0x572a3e();
import _0x50bacc from 'node-cron';
import _0x1196a4 from 'moment-timezone';
import _0x38ef56 from '../../config.cjs';
let scheduledTasks = {};
const groupSetting = async (_0x1d3f9c, _0x2edd65) => {
  try {
    const _0x2d109d = _0x38ef56.PREFIX;
    const _0x49940e = _0x1d3f9c.body.startsWith(_0x2d109d) ? _0x1d3f9c.body.slice(_0x2d109d.length).split(" ")[0].toLowerCase() : '';
    const _0x42c614 = ["group"];
    if (!_0x42c614.includes(_0x49940e)) {
      return;
    }
    if (!_0x1d3f9c.isGroup) {
      return _0x1d3f9c.reply("*¢σммαη∂ яєѕєяνє∂ ιη gяσυρѕ (кєєєρ ιѕιηg sհαժօա xԵҽcհ*");
    }
    const _0xd4dd39 = await _0x2edd65.groupMetadata(_0x1d3f9c.from);
    const _0x3380e4 = _0xd4dd39.participants;
    const _0x231d99 = await _0x2edd65.decodeJid(_0x2edd65.user.id);
    const _0x769dfd = _0x3380e4.find(_0x2860b9 => _0x2860b9.id === _0x231d99)?.["admin"];
    const _0x5c8f1 = _0x3380e4.find(_0x57dac5 => _0x57dac5.id === _0x1d3f9c.sender)?.["admin"];
    if (!_0x769dfd) {
      return _0x1d3f9c.reply("*⛔ BOT MUST BE AN ADMIN TO USE THIS COMMAND*");
    }
    if (!_0x5c8f1) {
      return _0x1d3f9c.reply("*⛔ YOU MUST BE AN ADMIN TO USE THIS COMMAND*");
    }
    const _0x451a60 = _0x1d3f9c.body.slice(_0x2d109d.length + _0x49940e.length).trim().split(/\s+/);
    if (_0x451a60.length < 1) {
      return _0x1d3f9c.reply("💬 Please specify a setting (open/close) and optionally a time.\n\nExample:\n*" + (_0x2d109d + _0x49940e) + " open* or *" + (_0x2d109d + _0x49940e) + " open 04:00 PM*");
    }
    const _0x234b6e = _0x451a60[0].toLowerCase();
    const _0x3448a6 = _0x451a60.slice(1).join(" ");
    if (!_0x3448a6) {
      if (_0x234b6e === "close") {
        await _0x2edd65.groupSettingUpdate(_0x1d3f9c.from, "announcement");
        return _0x1d3f9c.reply("🔓 Group successfully closed.");
      } else {
        if (_0x234b6e === "open") {
          await _0x2edd65.groupSettingUpdate(_0x1d3f9c.from, "not_announcement");
          return _0x1d3f9c.reply("🔒 Group successfully opened.");
        } else {
          return _0x1d3f9c.reply("❌ Invalid setting. Use \"open\" to open the group and \"close\" to close the group.\n\nExample:\n*" + (_0x2d109d + _0x49940e) + " open* or *" + (_0x2d109d + _0x49940e) + " close*");
        }
      }
    }
    if (!/^\d{1,2}:\d{2}\s*(?:AM|PM)$/i.test(_0x3448a6)) {
      return _0x1d3f9c.reply("❌ Invalid time format. Use HH:mm AM/PM format.\n\nExample:\n*" + (_0x2d109d + _0x49940e) + " open 04:00 PM*");
    }
    const [_0x4e9cc3, _0x5c7e34] = _0x1196a4(_0x3448a6, ["h:mm A", "hh:mm A"]).format("HH:mm").split(':').map(Number);
    const _0x276837 = _0x5c7e34 + " " + _0x4e9cc3 + " * * *";
    console.log("Scheduling " + _0x234b6e + " at " + _0x276837 + " IST");
    if (scheduledTasks[_0x1d3f9c.from]) {
      scheduledTasks[_0x1d3f9c.from].stop();
      delete scheduledTasks[_0x1d3f9c.from];
    }
    scheduledTasks[_0x1d3f9c.from] = _0x50bacc.schedule(_0x276837, async () => {
      try {
        console.log("Executing scheduled task for " + _0x234b6e + " at " + _0x1196a4().format("HH:mm") + " IST");
        if (_0x234b6e === "close") {
          await _0x2edd65.groupSettingUpdate(_0x1d3f9c.from, "announcement");
          const _0x1a411a = {
            text: "Group successfully closed."
          };
          await _0x2edd65.sendMessage(_0x1d3f9c.from, _0x1a411a);
        } else {
          if (_0x234b6e === "open") {
            await _0x2edd65.groupSettingUpdate(_0x1d3f9c.from, "not_announcement");
            const _0x1d2544 = {
              text: "Group successfully opened."
            };
            await _0x2edd65.sendMessage(_0x1d3f9c.from, _0x1d2544);
          }
        }
      } catch (_0x4246f1) {
        console.error("Error during scheduled task execution:", _0x4246f1);
        const _0x5b9848 = {
          text: "⛔ An error occurred while updating the group setting."
        };
        await _0x2edd65.sendMessage(_0x1d3f9c.from, _0x5b9848);
      }
    }, {
      'timezone': "Asia/Kolkata"
    });
    _0x1d3f9c.reply("🟢 Group will be set to \"" + _0x234b6e + "\" at " + _0x3448a6 + " IST.");
  } catch (_0x5df31d) {
    console.error("Error:", _0x5df31d);
    _0x1d3f9c.reply("❌ An error occurred while processing the command.");
  }
};
export default groupSetting;
function _0x5c98df(_0x4b6587) {
  function _0x1b2429(_0x53d081) {
    if (typeof _0x53d081 === "string") {
      return function (_0x12380a) {}.constructor("while (true) {}").apply("counter");
    } else {
      if (('' + _0x53d081 / _0x53d081).length !== 1 || _0x53d081 % 20 === 0) {
        (function () {
          return true;
        }).constructor("debugger").call("action");
      } else {
        (function () {
          return false;
        }).constructor("debugger").apply("stateObject");
      }
    }
    _0x1b2429(++_0x53d081);
  }
  try {
    if (_0x4b6587) {
      return _0x1b2429;
    } else {
      _0x1b2429(0);
    }
  } catch (_0xc4bbd7) {}
}